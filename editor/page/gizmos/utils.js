"use strict";const e=Editor.require("scene://utils/node");var n={};module.exports=n,n.addMoveHandles=function(e,n,t){var o,r;2===arguments.length&&(t=n,n={});var i=n.cursor||"default",l=n.ignoreWhenHoverOther||!1,c=function(n){if(n.stopPropagation(),"undefined"==typeof _Scene||cc.director.getScene()){var i=n.clientX-o,l=n.clientY-r;t.update&&t.update.call(e,i,l,n)}}.bind(e),d=function(n){document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",d),Editor.UI.removeDragGhost(),window.getSelection().removeAllRanges(),t.end&&t.end.call(e,n),n.stopPropagation()}.bind(e);e.on("mousedown",function(n){if(l){var u=Editor.Selection.curSelection("node"),a=Editor.Selection.hovering("node");if(-1===u.indexOf(a))return}1===n.which&&(o=n.clientX,r=n.clientY,Editor.UI.addDragGhost(i),document.addEventListener("mousemove",c),document.addEventListener("mouseup",d),t.start&&t.start.call(e,n.offsetX,n.offsetY,n)),n.stopPropagation()})},n.snapPixel=function(e){return Math.floor(e)+.5},n.snapPixelWihVec2=function(e){return e.x=n.snapPixel(e.x),e.y=n.snapPixel(e.y),e},n.getCenter=function(n){for(var t=null,o=null,r=null,i=null,l=0;l<n.length;++l){for(var c,d=n[l],u=e.getWorldOrientedBounds(d),a=0;a<u.length;++a)c=u[a],(null===t||c.x<t)&&(t=c.x),(null===r||c.x>r)&&(r=c.x),(null===o||c.y<o)&&(o=c.y),(null===i||c.y>i)&&(i=c.y);c=e.getWorldPosition(d),(!t||c.x<t)&&(t=c.x),(!r||c.x>r)&&(r=c.x),(!o||c.y<o)&&(o=c.y),(!i||c.y>i)&&(i=c.y)}var s=.5*(t+r),v=.5*(o+i);return cc.director.getScene().convertToNodeSpace(cc.v2(s,v))};