"use strict";const r=require("graceful-fs"),e=require("path"),t=require("./win32").invalidWin32Path,o=parseInt("0777",8);module.exports=function c(i,s,a){s&&"object"==typeof s||(s={mode:s});let n=s.mode;const d=s.fs||r;if("win32"===process.platform&&t(i)){const r=new Error(i+" contains invalid WIN32 path characters.");throw r.code="EINVAL",r}void 0===n&&(n=o&~process.umask()),a||(a=null),i=e.resolve(i);try{d.mkdirSync(i,n),a=a||i}catch(r){switch(r.code){case"ENOENT":if(e.dirname(i)===i)throw r;c(i,s,a=c(e.dirname(i),s,a));break;default:let t;try{t=d.statSync(i)}catch(e){throw r}if(!t.isDirectory())throw r}}return a};