"use strict";const e=require("graceful-fs"),r=require("path"),t=require("./win32").invalidWin32Path,n=parseInt("0777",8);module.exports=function i(o,s,c,a){if("function"==typeof s?(c=s,s={}):s&&"object"==typeof s||(s={mode:s}),"win32"===process.platform&&t(o)){const e=new Error(o+" contains invalid WIN32 path characters.");return e.code="EINVAL",c(e)}let u=s.mode;const l=s.fs||e;void 0===u&&(u=n&~process.umask()),a||(a=null),c=c||function(){},o=r.resolve(o),l.mkdir(o,u,e=>{if(!e)return c(null,a=a||o);switch(e.code){case"ENOENT":if(r.dirname(o)===o)return c(e);i(r.dirname(o),s,(e,r)=>{e?c(e,r):i(o,s,c,r)});break;default:l.stat(o,(r,t)=>{r||!t.isDirectory()?c(e,a):c(null,a)})}})};