"use strict";const n=require("path"),e=require("graceful-fs"),i=require("../mkdirs"),t=i.mkdirs,r=i.mkdirsSync,s=require("./symlink-paths"),y=s.symlinkPaths,u=s.symlinkPathsSync,c=require("./symlink-type"),m=c.symlinkType,o=c.symlinkTypeSync;function f(i,r,s,u){u="function"==typeof s?s:u,s="function"!=typeof s&&s,e.exists(r,c=>{if(c)return u(null);y(i,r,(y,c)=>{if(y)return u(y);i=c.toDst,m(c.toCwd,s,(s,y)=>{if(s)return u(s);const c=n.dirname(r);e.exists(c,n=>{if(n)return e.symlink(i,r,y,u);t(c,n=>{if(n)return u(n);e.symlink(i,r,y,u)})})})})})}function l(i,t,s,y){if(y="function"==typeof s?s:y,s="function"!=typeof s&&s,e.existsSync(t))return;const c=u(i,t);i=c.toDst,s=o(c.toCwd,s);const m=n.dirname(t);return e.existsSync(m)?e.symlinkSync(i,t,s):(r(m),e.symlinkSync(i,t,s))}module.exports={createSymlink:f,createSymlinkSync:l,ensureSymlink:f,ensureSymlinkSync:l};