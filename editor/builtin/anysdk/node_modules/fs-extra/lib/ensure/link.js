"use strict";const e=require("path"),n=require("graceful-fs"),r=require("../mkdirs");function s(s,t,i){function c(e,r){n.link(e,r,e=>{if(e)return i(e);i(null)})}n.exists(t,u=>{if(u)return i(null);n.lstat(s,(u,a)=>{if(u)return u.message=u.message.replace("lstat","ensureLink"),i(u);const l=e.dirname(t);n.exists(l,e=>{if(e)return c(s,t);r.mkdirs(l,e=>{if(e)return i(e);c(s,t)})})})})}function t(s,t,i){if(n.existsSync(t))return;try{n.lstatSync(s)}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}const c=e.dirname(t);return n.existsSync(c)?n.linkSync(s,t):(r.mkdirsSync(c),n.linkSync(s,t))}module.exports={createLink:s,createLinkSync:t,ensureLink:s,ensureLinkSync:t};