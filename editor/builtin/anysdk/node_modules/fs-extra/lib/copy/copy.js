"use strict";const e=require("graceful-fs"),r=require("path"),s=require("./ncp"),t=require("../mkdirs");module.exports=function(n,i,o,c){"function"!=typeof o||c?("function"==typeof o||o instanceof RegExp)&&(o={filter:o}):(c=o,o={}),c=c||function(){},(o=o||{}).preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269");const p=process.cwd();if(r.resolve(p,n)===r.resolve(p,i))return c(new Error("Source and destination must not be the same."));e.lstat(n,(p,u)=>{if(p)return c(p);let f=null;if(u.isDirectory()){const e=i.split(r.sep);e.pop(),f=e.join(r.sep)}else f=r.dirname(i);e.exists(f,e=>{if(e)return s(n,i,o,c);t.mkdirs(f,e=>{if(e)return c(e);s(n,i,o,c)})})})};