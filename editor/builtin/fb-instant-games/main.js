const e=require("fire-fs"),i=require("fire-path"),r=(require("gulp").Gulp,require("gulp-util"),require("async")),t=(require("event-stream"),require(Editor.url("app://editor/core/gulp-build.js")),require("./lib/jszip.min.js")),n=require("electron"),l="fb-instant-games";function u(u,o){if(u.platform!==l)return o();let d=new t;(function t(n,l,u){let o=e.readdirSync(n),d=0;if(d===o.length)return u();r.whilst(function(){return d<o.length},function(r){let u=o[d],s=i.join(n,u);e.lstatSync(s).isDirectory()?t(s,l.folder(u),()=>{d++,r()}):(l.file(u,e.readFileSync(s)),d++,r())},function(){u()})})(u.dest,d,()=>{let r=i.join(u.dest,u.title);d.generateNodeStream({type:"nodebuffer"}).pipe(e.createWriteStream(r+".zip")).on("finish",()=>{Editor.isWin32||(r=i.dirname(r)),n.shell.showItemInFolder(r),o()})})}module.exports={load(){Editor.Builder.on("build-finished",u)},unload(){Editor.Builder.removeListener("build-finished",u)},messages:{}};