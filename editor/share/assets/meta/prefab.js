"use strict";var t=require("fire-fs"),i=require("fire-path"),e=require("./custom-asset");module.exports=class extends e{constructor(t){super(t),this.optimizationPolicy="AUTO",this.asyncLoadAssets=!1,this.readonly=!1,this.content=void 0}handleJson(t,e){var s=Editor.serialize.findRootObject(e,"cc.Prefab");s?(s.optimizationPolicy=cc.Prefab.OptimizationPolicy[this.optimizationPolicy],s.asyncLoadAssets=this.asyncLoadAssets,s.readonly=this.readonly):Editor.warn(`Can not find prefab assset in the prefab file "${t}", it maybe corrupted!`),Editor.serialize.setName(e,i.basenameNoExt(t)),this._assetdb.saveAssetToLibrary(this.uuid,e)}import(i,e){if(this.content)return this.handleJson(i,this.content),e(),void 0;t.readJson(i,(t,s)=>{if(t)return e&&e(t),void 0;s&&this.handleJson(i,s),e&&e(t)})}static defaultType(){return"prefab"}};