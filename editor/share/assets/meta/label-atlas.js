"use strict";const t=Editor.metas["custom-asset"],e=require("fire-path"),i=require("./fnt-parser");module.exports=class extends t{constructor(t){super(t),this.itemWidth=0,this.itemHeight=0,this.startChar="",this.rawTextureUuid="",this.fontSize=0}static version(){return"1.1.0"}static defaultType(){return"label-atlas"}_createFntConfigString(t,e,i,a,s,r){var h=t.rawWidth,n=t.rawHeight,o=a.charCodeAt(0),d=`info face="Arial" size=${r} bold=0 italic=0 charset="" unicode=0 stretchH=100 smooth=1 aa=1 padding=0,0,0,0 spaceing=0,0\n`;d+=`common lineHeight=${i} base=${r} scaleW=${h} scaleH=${n} pages=1 packed=0\n`,d+=`page id=0 file="${s}"\n`,d+="chars count=0\n";for(var c=0,u=i;u<=n;u+=i)for(var f=0;f<h&&f+e<=h;f+=e){var g=o+c;d+=`char id=${g}     x=${f}   y=${u-i}   width=${e}     height=${i}     xoffset=0     yoffset=0    xadvance=${e}    page=0 chnl=0 letter="${String.fromCharCode(g)}"\n`,++c}return d}postImport(t,a){var s=this._assetdb,r=new cc.LabelAtlas;r.name=e.basenameNoExt(t);var h=.88*this.itemHeight,n=s.loadMetaByUuid(this.rawTextureUuid);if(n){let t=s.uuidToFspath(n.uuid);var o=n.getSubMetas(),d=e.basenameNoExt(t),c=o[d];if(r.spriteFrame=Editor.serialize.asAsset(c.uuid),this.itemWidth>0&&this.itemHeight>0&&this.itemWidth<=c.rawWidth&&this.itemHeight<=c.rawHeight){var u=this._createFntConfigString(c,this.itemWidth,this.itemHeight,this.startChar,d,h);r._fntConfig=i.parseFnt(u)}}return r.fontSize=h,this.fontSize=h,s.saveAssetToLibrary(this.uuid,r),a()}};