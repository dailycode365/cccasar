"use strict";var e=require("fire-fs"),t=require("fire-url"),r=require("lodash");module.exports=exports=Editor.Utils||{},exports.urlToPath=function(e){return decodeURIComponent(t.parse(e).pathname)},exports.filterAsync=function(e,t,r){var i=require("async");i.someSeries?i.filter(e,t,r):i.filter(e,function(e,r){t(e,function(e,t){r(t)})},function(e){r(null,e)})},exports.asyncif=function(e,t){return e?t:function(e){e()}},exports.MultipleValueDict=class{constructor(){this.dict={}}get(e){return this.dict[e]}add(e,t){var r=this.dict,i=r[e];return i?Array.isArray(i)?i.push(t):r[e]=[i,t]:r[e]=t,this}value(){return this.dict}multiple(){return r.pickBy(this.dict,r.isArray)}},exports.toString=function(e){return e?e.toString?e.toString():"Object":""+e},exports.refreshSelectedInspector=function(e,t){var r=Editor.Selection.curGlobalActivate();r&&r.id===t&&r.type===e&&(Editor.Selection.unselect(e,t),(r=Editor.Selection.curGlobalActivate())&&r.type===e&&r.id?setTimeout(function(){Editor.Selection.select(e,t,!1)},200):Editor.Selection.select(e,t,!1))},exports.getDependsRecursively=function(){function e(t,r,i,n){t[i]=!0;var o=r[i];if(o&&(n&&(o=o[n]),o&&o.length>0))for(var u=0;u<o.length;u++){var c=o[u];t[c]||e(t,r,c,n)}}return function(t,r,i){var n=Object.create(null);if(Array.isArray(r)){for(let o=0;o<r.length;o++)e(n,t,r[o],i);for(let e=0;e<r.length;e++)delete n[r[e]]}else e(n,t,r,i),delete n[r];return Object.keys(n)}}(),exports.UuidCache=function(){var t=/\\/g,r={};function i(t){if(!t)return"";var r=cc.AssetLibrary.parseUuidInEditor(t);if(r)return r;var i=Editor.Utils.urlToPath(t+".meta");if(e.existsSync(i))try{var n=e.readFileSync(i);r=JSON.parse(n).uuid||""}catch(e){}return r}return Editor.isRendererProcess?{urlToUuid:function(e){e=e.replace(t,"/");var n=r[e];return n||((n=i(e))&&(r[e]=n),n)},cache:function(e,n){if(e=e.replace(t,"/"),!n){if(n=r[e])return;n=i(e)}n&&(r[e]=n)},clear:function(){r={}}}:{urlToUuid:function(e){return Editor.assetdb.urlToUuid(e)}}}();